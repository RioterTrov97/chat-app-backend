(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{100:function(e,t,c){},101:function(e,t,c){},102:function(e,t,c){},132:function(e,t,c){},133:function(e,t,c){"use strict";c.r(t);var a=c(1),n=c.n(a),s=c(29),r=c.n(s),o=(c(71),c(23)),i=c(4),l=c(5),u=(c(76),c(77),c(78),c(0));var d=function(){return Object(u.jsxs)("div",{className:"sk-circle",children:[Object(u.jsx)("div",{className:"sk-circle1 sk-child"}),Object(u.jsx)("div",{className:"sk-circle2 sk-child"}),Object(u.jsx)("div",{className:"sk-circle3 sk-child"}),Object(u.jsx)("div",{className:"sk-circle4 sk-child"}),Object(u.jsx)("div",{className:"sk-circle5 sk-child"}),Object(u.jsx)("div",{className:"sk-circle6 sk-child"}),Object(u.jsx)("div",{className:"sk-circle7 sk-child"}),Object(u.jsx)("div",{className:"sk-circle8 sk-child"}),Object(u.jsx)("div",{className:"sk-circle9 sk-child"}),Object(u.jsx)("div",{className:"sk-circle10 sk-child"}),Object(u.jsx)("div",{className:"sk-circle11 sk-child"}),Object(u.jsx)("div",{className:"sk-circle12 sk-child"})]})},j=c(3),p=c(7),h=c.n(p),O=c(17),b=c(22),m=c.n(b),f="USER_LOGIN_REQUEST",v="USER_LOGIN_SUCCESS",g="USER_LOGIN_FAIL",x="USER_LOGOUT",S="USER_REGISTER_REQUEST",E="USER_REGISTER_SUCCESS",_="USER_REGISTER_FAIL",R="USER_VERIFY_REQUEST",C="USER_VERIFY_SUCCESS",N="USER_VERIFY_FAIL",y="USER_DETAILS_REQUEST",k="USER_DETAILS_SUCCESS",T="USER_DETAILS_FAIL",I="USER_DETAILS_RESET",L=JSON.parse(localStorage.getItem("userInfo")),A=m.a.create({baseURL:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_URL2:"http://127.0.0.1:8000/api/"}).REACT_APP_URL||"https://chat-app-socket-2021.herokuapp.com/api/"}),U=m.a.create({baseURL:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_URL2:"http://127.0.0.1:8000/api/"}).REACT_APP_URL||"https://chat-app-socket-2021.herokuapp.com/api/",headers:{Authorization:"Bearer "+(null===L||void 0===L?void 0:L.token)}}),P=m.a.create({baseURL:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_URL2:"http://127.0.0.1:8000/api/"}).REACT_APP_URL||"https://chat-app-socket-2021.herokuapp.com/api/",headers:{Authorization:"Bearer "+(null===L||void 0===L?void 0:L.token)}}),D=A,w=function(){return function(e){localStorage.removeItem("userInfo"),localStorage.removeItem("chatroomList"),e({type:x}),e({type:I}),document.location.href="/login"}};var B=Object(j.i)((function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),c=t[0],n=t[1],s=Object(a.useState)(""),r=Object(i.a)(s,2),o=r[0],j=r[1],p=Object(a.useState)(""),b=Object(i.a)(p,2),m=b[0],x=b[1],R=Object(a.useState)(""),C=Object(i.a)(R,2),N=C[0],y=C[1],k=Object(l.b)(),T=Object(l.c)((function(e){return e.userLogin})),I=T.loading,L=T.error,A=T.userInfo;return Object(u.jsxs)("div",{className:"login",children:[Object(u.jsxs)("div",{className:"logo",children:[Object(u.jsx)("img",{src:"https://icon-library.com/images/chat-icon-png/chat-icon-png-4.jpg",alt:""}),Object(u.jsx)("p",{children:"OpenChat"})]}),Object(u.jsx)("div",{className:"ComName",children:Object(u.jsx)("span",{children:"Open to find your interests"})}),I?Object(u.jsx)(d,{}):Object(u.jsxs)("div",{children:[Object(u.jsxs)("form",{children:[c?Object(u.jsx)("div",{className:"logins",children:Object(u.jsx)("input",{className:"loginInput",value:o,onChange:function(e){return j(e.target.value)},placeholder:"Full name",type:"text"})}):null,Object(u.jsx)("input",{className:"loginInput",value:m,onChange:function(e){return x(e.target.value)},placeholder:"Email",type:"email"}),Object(u.jsx)("input",{className:"loginInput",value:N,onChange:function(e){return y(e.target.value)},placeholder:"Password",type:"password"}),Object(u.jsx)("button",{type:"submit",className:"loginButton",onClick:c?function(e){e.preventDefault(),console.log(L),console.log(A),k(function(e,t,c){return function(){var a=Object(O.a)(h.a.mark((function a(n){var s,r;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,n({type:S}),a.next=4,D.post("/user/register",{name:e,email:t,password:c});case 4:s=a.sent,r=s.data,n({type:E,payload:r}),n({type:v,payload:r}),document.location.href="/",localStorage.setItem("userInfo",JSON.stringify(r)),a.next=15;break;case 12:a.prev=12,a.t0=a.catch(0),n({type:_,payload:a.t0.response&&a.t0.response.data.message?a.t0.response.data.message:a.t0.message});case 15:case"end":return a.stop()}}),a,null,[[0,12]])})));return function(e){return a.apply(this,arguments)}}()}(o,m,N))}:function(e){e.preventDefault(),k(function(e,t){return function(){var c=Object(O.a)(h.a.mark((function c(a){var n,s;return h.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,a({type:f}),c.next=4,D.post("/user/login",{email:e,password:t});case 4:n=c.sent,s=n.data,a({type:v,payload:s}),document.location.href="/",localStorage.setItem("userInfo",JSON.stringify(s)),c.next=14;break;case 11:c.prev=11,c.t0=c.catch(0),a({type:g,payload:c.t0.response&&c.t0.response.data.message?c.t0.response.data.message:c.t0.message});case 14:case"end":return c.stop()}}),c,null,[[0,11]])})));return function(e){return c.apply(this,arguments)}}()}(m,N))},children:c?"Sign Up":"Sign In"})]}),Object(u.jsxs)("p",{children:["Not a member?"," ",Object(u.jsx)("span",{className:"login__register",onClick:function(){return n(!c)},children:c?"Login":"Register Now"})]})]})]})})),H=(c(99),c(100),function(e){var t=e.id,c=e.user,n=e.name,s=e.image,r=e.description,o=Object(j.g)(),l=Object(a.useState)(""),d=Object(i.a)(l,2),p=d[0],h=d[1];Object(a.useEffect)((function(){P.post("/user/",{id:c}).then((function(e){h(e.data.username)})).catch((function(e){console.log(e)}))}),[]);var O;return Object(u.jsxs)("div",{className:"chatRoom",children:[Object(u.jsx)("img",{className:"chatRoomImg",src:s,alt:n}),Object(u.jsx)("p",{className:"chatRoomName",children:n}),Object(u.jsx)("p",{className:"chatRoomDesc",children:r}),Object(u.jsxs)("p",{className:"chatRoomCreated",children:["- ",(O=p.split(" ")[0],O.charAt(0).toUpperCase()+O.substring(1))]}),Object(u.jsx)("div",{onClick:function(){return o.push("/chatpage/".concat(t))},className:"joinChatRoom",children:"Join"})]})}),F="CHATROOM_LIST_REQUEST",M="CHATROOM_LIST_SUCCESS",W="CHATROOM_LIST_FAIL",K="CHATROOM_CREATE_REQUEST",G="CHATROOM_CREATE_SUCCESS",V="CHATROOM_CREATE_FAIL",J="CHATROOM_CREATE_RESET",Q=function(){return function(){var e=Object(O.a)(h.a.mark((function e(t){var c,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:F}),e.next=4,U.get("/chatroom");case 4:c=e.sent,a=c.data,t({type:M,payload:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),t({type:W,payload:e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()};var z=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.userLogin})),c=t.loading,n=t.userInfo,s=Object(l.c)((function(e){return e.chatroomList})),r=s.loading,o=s.chatrooms;return Object(a.useEffect)((function(){(null===n||void 0===n?void 0:n.user)&&e(Q())}),[e,n]),Object(u.jsx)("div",{className:"chatroomsContainer",children:r||c?Object(u.jsx)(d,{}):Object(u.jsx)("div",{className:"chatRoomsList",children:Object(u.jsxs)("div",{className:"chatList",children:[Object(u.jsx)("p",{className:"chatListHeader",children:"Public Chatrooms"}),Object(u.jsx)("div",{className:"chatListRooms",children:null===o||void 0===o?void 0:o.map((function(e){return Object(u.jsx)(H,{id:e._id,user:e.user,name:e.name,image:e.image,description:e.description},e._id)}))})]})})})},Y=(c(101),function(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),c=t[0],n=t[1],s=Object(a.useState)(""),r=Object(i.a)(s,2),o=r[0],d=r[1],p=Object(a.useState)(""),b=Object(i.a)(p,2),m=b[0],f=b[1],v=Object(j.g)(),g=Object(l.b)(),x=Object(l.c)((function(e){return e.chatroomCreate})).success;Object(a.useEffect)((function(){x&&(n(""),f(""),d(""))}),[x]);var S=function(e){var t,a,n;e.preventDefault(),g((t=c,a=o,n=m,function(){var e=Object(O.a)(h.a.mark((function e(c){var s,r,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c({type:K}),e.next=4,U.post("/chatroom",{name:t,image:a,description:n});case 4:s=e.sent,r=s.data,c({type:G,payload:r}),c(Q()),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),"Not authorized, token failed"===(o=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message)&&c(w()),c({type:V,payload:o});case 15:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()))};return Object(u.jsxs)("div",{className:"createChatContainer",children:[Object(u.jsx)("button",{className:"createChatGoBack",onClick:function(){return v.push("/")},children:"Go Back"}),Object(u.jsxs)("div",{className:"createChat",children:[Object(u.jsx)("h3",{children:"Create New Chatroom"}),Object(u.jsxs)("div",{children:[Object(u.jsx)("input",{value:c,onChange:function(e){return n(e.target.value)},placeholder:"Enter Chatroom Name",type:"text"}),Object(u.jsx)("input",{value:o,onChange:function(e){return d(e.target.value)},placeholder:"Enter Chatroom Pic URL",type:"text"}),Object(u.jsx)("textarea",{value:m,onChange:function(e){return f(e.target.value)},placeholder:"Enter Chatroom Description",type:"text"}),Object(u.jsx)("button",{className:"createChat__button",onClick:function(e){return S(e)},children:"Create"})]})]})]})}),q=c(25);c(102);var X=function(e){var t,c,n,s,r=e.socket,o=e.setupSoc,p=Object(j.h)().id,h=Object(a.useState)(null),O=Object(i.a)(h,2),b=O[0],m=O[1],f=Object(a.useState)(""),v=Object(i.a)(f,2),g=v[0],x=v[1],S=Object(a.useState)([]),E=Object(i.a)(S,2),_=E[0],R=E[1],C=Object(a.useState)(!1),N=Object(i.a)(C,2),y=N[0],k=N[1],T=Object(a.useState)(!1),I=Object(i.a)(T,2),L=I[0],A=I[1],U=Object(a.useState)(!1),D=Object(i.a)(U,2),w=D[0],B=D[1],H=Object(l.c)((function(e){return e.userLogin})).userInfo,F=Object(j.g)(),M={chatroomId:p};Object(a.useEffect)((function(){B(!0),P.post("/chatroom/name",M).then((function(e){console.log(e.data),m(e.data),B(!1)})).catch((function(e){console.log(e),B(!1)}))}),[]),Object(a.useEffect)((function(){P.post("/message/messages",{chatroomId:p}).then((function(e){R(e.data)})).catch((function(e){console.log(e)}))}),[y]);var W,K=function(e,t){e.preventDefault(),r&&!t&&(r.emit("ChatroomMessage",p,g),x("")),"Enter"===e.key&&r&&(r.emit("ChatroomMessage",p,g),x(""))},G=function(){var e=Object(a.useRef)();return Object(a.useEffect)((function(){return e.current.scrollIntoView()})),Object(u.jsx)("div",{ref:e})};return Object(a.useEffect)((function(){if(r)return console.log("socket is here"),r.emit("joinRoom",p),r.on("newMessage",(function(){k((function(e){return!e})),x("")})),function(){r.emit("leaveRoom",p)};console.log("setting up socket again"),A(!L),o()}),[L]),Object(u.jsx)("div",{className:"chatBox__container",children:Object(u.jsx)("div",{className:"chatBoxMain",children:w?Object(u.jsx)(d,{}):Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"chatBoxMiddle",children:Object(u.jsxs)("div",{className:"chatBox",children:[Object(u.jsxs)("div",{className:"chatHead",children:[Object(u.jsx)("div",{className:"backButton",onClick:function(){return F.push("/")},children:"Back"}),Object(u.jsxs)("p",{children:["Welcome to"," ",null===b||void 0===b||null===(t=b.chatroom)||void 0===t?void 0:t.name]})]}),Object(u.jsxs)("div",{className:"chatBody",children:[_.map((function(e,t){return Object(u.jsxs)("div",{className:"messages",children:[Object(u.jsx)("div",{className:H.user.id===e.user?"myName":"otherName",children:e.name}),Object(u.jsx)("span",{className:H.user.id===e.user?"myMessage":"OtherMessage",children:e.message})]},t)})),Object(u.jsx)(G,{})]}),Object(u.jsxs)("div",{className:"chatInput",children:[Object(u.jsx)("input",{value:g,onKeyUp:function(e){return K(e,true)},onChange:function(e){return x(e.target.value)},placeholder:"New Message",type:"text"}),Object(u.jsxs)("button",{onClick:function(e){return K(e)},children:[Object(u.jsx)("i",{className:"fas fa-paper-plane"}),Object(u.jsx)("p",{children:"Send"})]})]})]})}),Object(u.jsxs)("div",{className:"chatBoxRight",children:[Object(u.jsx)("div",{className:"chatBoxImgContainer",children:Object(u.jsx)("img",{className:"chatBoxImg",src:null===b||void 0===b||null===(c=b.chatroom)||void 0===c?void 0:c.image,alt:null===b||void 0===b||null===(n=b.chatroom)||void 0===n?void 0:n.name})}),Object(u.jsx)("p",{className:"chatBoxDesc",children:null===b||void 0===b||null===(s=b.chatroom)||void 0===s?void 0:s.description}),Object(u.jsxs)("p",{className:"chatBoxAdmin",children:["Room Owner:"," ",Object(u.jsx)("span",{children:(null===b||void 0===b?void 0:b.username)&&(W=b.username.split(" ")[0],W.charAt(0).toUpperCase()+W.substring(1))})]})]})]})})})},Z=c(64);c(132);var $=Object(j.i)((function(){var e=Object(l.b)(),t=Object(j.g)();return Object(u.jsxs)("div",{className:"header",children:[Object(u.jsxs)("div",{className:"headerLeft",onClick:function(){return t.push("/")},children:[Object(u.jsx)("img",{src:"https://icon-library.com/images/chat-icon-png/chat-icon-png-4.jpg",alt:""}),Object(u.jsx)("p",{children:"OpenChat"})]}),Object(u.jsxs)("div",{className:"headerNavItems",onClick:function(){return t.push("/create")},children:[Object(u.jsx)("i",{className:"fas fa-plus-circle"}),Object(u.jsx)("p",{children:"Create Chatroom"})]}),Object(u.jsxs)("div",{className:"headerNavItems",onClick:function(t){!function(t){t.preventDefault(),e(w())}(t)},children:[Object(u.jsx)("i",{className:"fas fa-sign-out-alt"}),Object(u.jsx)("p",{children:"Log Out"})]})]})}));var ee=function(){var e=Object(a.useState)(null),t=Object(i.a)(e,2),c=t[0],n=t[1],s=Object(l.b)(),r=Object(l.c)((function(e){return e.userLogin})),p=r.loading,b=r.userInfo,m=function e(){if((null===b||void 0===b?void 0:b.token)&&!c){var t=Z.io.connect(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_URL2:"http://127.0.0.1:8000/api/"}).REACT_APP_URL||"https://chat-app-socket-2021.herokuapp.com",{query:{token:null===b||void 0===b?void 0:b.token}});t.on("disconnect",(function(){n(null),setTimeout(e,6e3)})),t.on("connect",(function(){console.log("Success: Socket Connected!")})),n(t)}};return Object(a.useEffect)((function(){localStorage.getItem("userInfo")&&s(function(){var e=Object(O.a)(h.a.mark((function e(t){var c,a,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:R}),e.next=4,U.get("/user/me");case 4:c=e.sent,a=c.data,t({type:C,payload:a}),t({type:v,payload:a}),localStorage.setItem("userInfo",JSON.stringify(a)),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(0),"Not authorized, token failed"===(n=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message)&&t(w()),t({type:N,payload:n});case 16:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}())}),[s]),Object(a.useEffect)((function(){m()}),[]),Object(u.jsx)("div",{className:"App",children:Object(u.jsx)("div",{children:Object(u.jsx)(q.a,{children:p?Object(u.jsx)(d,{}):b?Object(u.jsxs)("div",{children:[Object(u.jsx)($,{}),Object(u.jsxs)(j.d,{children:[Object(u.jsx)(j.b,{path:"/",exact:!0,render:function(){return Object(u.jsx)(z,{socket:c})}}),Object(u.jsx)(j.b,{path:"/create",exact:!0,render:function(){return Object(u.jsx)(Y,{})}}),Object(u.jsx)(j.b,{path:"/login",exact:!0,children:function(){return Object(u.jsx)(B,{setupSoc:m})}}),Object(u.jsx)(j.b,{path:"/chatpage/:id",exact:!0,render:function(e){return Object(u.jsx)(X,Object(o.a)(Object(o.a)({},e),{},{socket:c,setupSoc:m}))}}),Object(u.jsx)(j.a,{to:"/"})]})]}):Object(u.jsx)(B,{})})})})},te=c(18),ce=c(65),ae=c(66),ne=Object(te.combineReducers)({userLogin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return{loading:!0};case v:return{loading:!1,userInfo:t.payload};case g:return{loading:!1,error:t.payload};case x:return{};default:return e}},userRegister:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:return{loading:!0};case E:return{loading:!1,userInfo:t.payload};case _:return{loading:!1,error:t.payload};case x:return{};default:return e}},userDetails:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{user:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return Object(o.a)(Object(o.a)({},e),{},{loading:!0});case k:return{loading:!1,user:t.payload};case T:return{loading:!1,error:t.payload};case I:return{user:{}};default:return e}},userVerify:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R:return{loading:!0};case C:return{loading:!1,success:!0,userInfo:t.payload};case N:return{loading:!1,error:t.payload};default:return e}},chatroomList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{chatrooms:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case F:return{loading:!0,chatrooms:[]};case M:return{loading:!1,chatrooms:t.payload};case W:return{loading:!1,error:t.payload};default:return e}},chatroomCreate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case K:return{loading:!0};case G:return{loading:!1,success:!0,chatroom:t.payload};case V:return{loading:!1,error:t.payload};case J:return{};default:return e}}}),se={userLogin:{userInfo:localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")):null}},re=[ce.a],oe=Object(te.createStore)(ne,se,Object(ae.composeWithDevTools)(te.applyMiddleware.apply(void 0,re)));r.a.render(Object(u.jsx)(n.a.StrictMode,{children:Object(u.jsx)(l.a,{store:oe,children:Object(u.jsx)(ee,{})})}),document.getElementById("root"))},71:function(e,t,c){},76:function(e,t,c){},77:function(e,t,c){},78:function(e,t,c){},99:function(e,t,c){}},[[133,1,2]]]);
//# sourceMappingURL=main.4f7421a2.chunk.js.map