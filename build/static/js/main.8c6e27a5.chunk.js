(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{100:function(e,t,c){},101:function(e,t,c){},102:function(e,t,c){},132:function(e,t,c){},133:function(e,t,c){"use strict";c.r(t);var a=c(1),n=c.n(a),s=c(29),r=c.n(s),o=(c(71),c(23)),i=c(4),l=c(5),u=(c(76),c(77),c(78),c(0));var d=function(){return Object(u.jsxs)("div",{className:"sk-circle",children:[Object(u.jsx)("div",{className:"sk-circle1 sk-child"}),Object(u.jsx)("div",{className:"sk-circle2 sk-child"}),Object(u.jsx)("div",{className:"sk-circle3 sk-child"}),Object(u.jsx)("div",{className:"sk-circle4 sk-child"}),Object(u.jsx)("div",{className:"sk-circle5 sk-child"}),Object(u.jsx)("div",{className:"sk-circle6 sk-child"}),Object(u.jsx)("div",{className:"sk-circle7 sk-child"}),Object(u.jsx)("div",{className:"sk-circle8 sk-child"}),Object(u.jsx)("div",{className:"sk-circle9 sk-child"}),Object(u.jsx)("div",{className:"sk-circle10 sk-child"}),Object(u.jsx)("div",{className:"sk-circle11 sk-child"}),Object(u.jsx)("div",{className:"sk-circle12 sk-child"})]})},j=c(3),h=c(7),p=c.n(h),b=c(17),O=c(22),m=c.n(O),f="USER_LOGIN_REQUEST",v="USER_LOGIN_SUCCESS",g="USER_LOGIN_FAIL",x="USER_LOGOUT",S="USER_REGISTER_REQUEST",N="USER_REGISTER_SUCCESS",y="USER_REGISTER_FAIL",E="USER_VERIFY_REQUEST",C="USER_VERIFY_SUCCESS",k="USER_VERIFY_FAIL",R="USER_DETAILS_REQUEST",I="USER_DETAILS_SUCCESS",_="USER_DETAILS_FAIL",L="USER_DETAILS_RESET",U=JSON.parse(localStorage.getItem("userInfo")),T=m.a.create({baseURL:"http://127.0.0.1:8000/api/"}),w=m.a.create({baseURL:"http://127.0.0.1:8000/api/",headers:{Authorization:"Bearer "+(null===U||void 0===U?void 0:U.token)}}),A=m.a.create({baseURL:"http://127.0.0.1:8000/api/",headers:{Authorization:"Bearer "+(null===U||void 0===U?void 0:U.token)}}),B=T,M=function(){return function(e){localStorage.removeItem("userInfo"),localStorage.removeItem("chatroomList"),e({type:x}),e({type:L}),document.location.href="/login"}};var D=Object(j.i)((function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),c=t[0],n=t[1],s=Object(a.useState)(""),r=Object(i.a)(s,2),o=r[0],j=r[1],h=Object(a.useState)(""),O=Object(i.a)(h,2),m=O[0],x=O[1],E=Object(a.useState)(""),C=Object(i.a)(E,2),k=C[0],R=C[1],I=Object(l.b)(),_=Object(l.c)((function(e){return e.userLogin})),L=_.loading,U=_.error,T=_.userInfo;return Object(u.jsxs)("div",{className:"login",children:[Object(u.jsxs)("div",{className:"logo",children:[Object(u.jsx)("img",{src:"https://icon-library.com/images/chat-icon-png/chat-icon-png-4.jpg",alt:""}),Object(u.jsx)("p",{children:"OpenChat"})]}),Object(u.jsx)("div",{className:"ComName",children:Object(u.jsx)("span",{children:"Open to find your interests"})}),L?Object(u.jsx)(d,{}):Object(u.jsxs)("div",{children:[Object(u.jsxs)("form",{children:[c?Object(u.jsx)("div",{className:"logins",children:Object(u.jsx)("input",{className:"loginInput",value:o,onChange:function(e){return j(e.target.value)},placeholder:"Full name",type:"text"})}):null,Object(u.jsx)("input",{className:"loginInput",value:m,onChange:function(e){return x(e.target.value)},placeholder:"Email",type:"email"}),Object(u.jsx)("input",{className:"loginInput",value:k,onChange:function(e){return R(e.target.value)},placeholder:"Password",type:"password"}),Object(u.jsx)("button",{type:"submit",className:"loginButton",onClick:c?function(e){e.preventDefault(),console.log(U),console.log(T),I(function(e,t,c){return function(){var a=Object(b.a)(p.a.mark((function a(n){var s,r;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,n({type:S}),a.next=4,B.post("/user/register",{name:e,email:t,password:c});case 4:s=a.sent,r=s.data,n({type:N,payload:r}),n({type:v,payload:r}),document.location.href="/",localStorage.setItem("userInfo",JSON.stringify(r)),a.next=15;break;case 12:a.prev=12,a.t0=a.catch(0),n({type:y,payload:a.t0.response&&a.t0.response.data.message?a.t0.response.data.message:a.t0.message});case 15:case"end":return a.stop()}}),a,null,[[0,12]])})));return function(e){return a.apply(this,arguments)}}()}(o,m,k))}:function(e){e.preventDefault(),I(function(e,t){return function(){var c=Object(b.a)(p.a.mark((function c(a){var n,s;return p.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,a({type:f}),c.next=4,B.post("/user/login",{email:e,password:t});case 4:n=c.sent,s=n.data,a({type:v,payload:s}),document.location.href="/",localStorage.setItem("userInfo",JSON.stringify(s)),c.next=14;break;case 11:c.prev=11,c.t0=c.catch(0),a({type:g,payload:c.t0.response&&c.t0.response.data.message?c.t0.response.data.message:c.t0.message});case 14:case"end":return c.stop()}}),c,null,[[0,11]])})));return function(e){return c.apply(this,arguments)}}()}(m,k))},children:c?"Sign Up":"Sign In"})]}),Object(u.jsxs)("p",{children:["Not a member?"," ",Object(u.jsx)("span",{className:"login__register",onClick:function(){return n(!c)},children:c?"Login":"Register Now"})]})]})]})})),F=(c(99),c(100),function(e){var t=e.id,c=e.user,n=e.name,s=e.image,r=e.description,o=Object(j.g)(),l=Object(a.useState)(""),d=Object(i.a)(l,2),h=d[0],p=d[1];Object(a.useEffect)((function(){A.post("/user/",{id:c}).then((function(e){p(e.data.username)})).catch((function(e){console.log(e)}))}),[]);var b;return Object(u.jsxs)("div",{className:"chatRoom",children:[Object(u.jsx)("img",{className:"chatRoomImg",src:s,alt:n}),Object(u.jsx)("p",{className:"chatRoomName",children:n}),Object(u.jsx)("p",{className:"chatRoomDesc",children:r}),Object(u.jsxs)("p",{className:"chatRoomCreated",children:["- ",(b=h.split(" ")[0],b.charAt(0).toUpperCase()+b.substring(1))]}),Object(u.jsx)("div",{onClick:function(){return o.push("/chatpage/".concat(t))},className:"joinChatRoom",children:"Join"})]})}),G="CHATROOM_LIST_REQUEST",H="CHATROOM_LIST_SUCCESS",J="CHATROOM_LIST_FAIL",Q="CHATROOM_CREATE_REQUEST",V="CHATROOM_CREATE_SUCCESS",z="CHATROOM_CREATE_FAIL",P="CHATROOM_CREATE_RESET",Y=function(){return function(){var e=Object(b.a)(p.a.mark((function e(t){var c,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:G}),e.next=4,w.get("/chatroom");case 4:c=e.sent,a=c.data,t({type:H,payload:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),t({type:J,payload:e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()};var W=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.userLogin})),c=t.loading,n=t.userInfo,s=Object(l.c)((function(e){return e.chatroomList})),r=s.loading,o=s.chatrooms;return Object(a.useEffect)((function(){(null===n||void 0===n?void 0:n.user)&&e(Y())}),[e,n]),Object(u.jsx)("div",{className:"chatroomsContainer",children:r||c?Object(u.jsx)(d,{}):Object(u.jsx)("div",{className:"chatRoomsList",children:Object(u.jsxs)("div",{className:"chatList",children:[Object(u.jsx)("p",{className:"chatListHeader",children:"Public Chatrooms"}),Object(u.jsx)("div",{className:"chatListRooms",children:null===o||void 0===o?void 0:o.map((function(e){return Object(u.jsx)(F,{id:e._id,user:e.user,name:e.name,image:e.image,description:e.description},e._id)}))})]})})})},q=(c(101),function(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),c=t[0],n=t[1],s=Object(a.useState)(""),r=Object(i.a)(s,2),o=r[0],d=r[1],h=Object(a.useState)(""),O=Object(i.a)(h,2),m=O[0],f=O[1],v=Object(j.g)(),g=Object(l.b)(),x=Object(l.c)((function(e){return e.chatroomCreate})).success;Object(a.useEffect)((function(){x&&(n(""),f(""),d(""))}),[x]);var S=function(e){var t,a,n;e.preventDefault(),g((t=c,a=o,n=m,function(){var e=Object(b.a)(p.a.mark((function e(c){var s,r,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c({type:Q}),e.next=4,w.post("/chatroom",{name:t,image:a,description:n});case 4:s=e.sent,r=s.data,c({type:V,payload:r}),c(Y()),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),"Not authorized, token failed"===(o=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message)&&c(M()),c({type:z,payload:o});case 15:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()))};return Object(u.jsxs)("div",{className:"createChatContainer",children:[Object(u.jsx)("button",{className:"createChatGoBack",onClick:function(){return v.push("/")},children:"Go Back"}),Object(u.jsxs)("div",{className:"createChat",children:[Object(u.jsx)("h3",{children:"Create New Chatroom"}),Object(u.jsxs)("div",{children:[Object(u.jsx)("input",{value:c,onChange:function(e){return n(e.target.value)},placeholder:"Enter Chatroom Name",type:"text"}),Object(u.jsx)("input",{value:o,onChange:function(e){return d(e.target.value)},placeholder:"Enter Chatroom Pic URL",type:"text"}),Object(u.jsx)("textarea",{value:m,onChange:function(e){return f(e.target.value)},placeholder:"Enter Chatroom Description",type:"text"}),Object(u.jsx)("button",{className:"createChat__button",onClick:function(e){return S(e)},children:"Create"})]})]})]})}),K=c(25);c(102);var X=function(e){var t,c,n,s,r=e.socket,o=e.setupSoc,h=Object(j.h)().id,p=Object(a.useState)(null),b=Object(i.a)(p,2),O=b[0],m=b[1],f=Object(a.useState)(""),v=Object(i.a)(f,2),g=v[0],x=v[1],S=Object(a.useState)([]),N=Object(i.a)(S,2),y=N[0],E=N[1],C=Object(a.useState)(!1),k=Object(i.a)(C,2),R=k[0],I=k[1],_=Object(a.useState)(!1),L=Object(i.a)(_,2),U=L[0],T=L[1],w=Object(a.useState)(!1),B=Object(i.a)(w,2),M=B[0],D=B[1],F=Object(l.c)((function(e){return e.userLogin})).userInfo,G=Object(j.g)(),H={chatroomId:h};Object(a.useEffect)((function(){D(!0),A.post("/chatroom/name",H).then((function(e){console.log(e.data),m(e.data),D(!1)})).catch((function(e){console.log(e),D(!1)}))}),[]),Object(a.useEffect)((function(){A.post("/message/messages",{chatroomId:h}).then((function(e){E(e.data)})).catch((function(e){console.log(e)}))}),[R]);var J,Q=function(e,t){e.preventDefault(),r&&!t&&(r.emit("ChatroomMessage",h,g),x("")),"Enter"===e.key&&r&&(r.emit("ChatroomMessage",h,g),x(""))},V=function(){var e=Object(a.useRef)();return Object(a.useEffect)((function(){return e.current.scrollIntoView()})),Object(u.jsx)("div",{ref:e})};return Object(a.useEffect)((function(){if(r)return console.log("socket is here"),r.emit("joinRoom",h),r.on("newMessage",(function(){I((function(e){return!e})),x("")})),function(){r.emit("leaveRoom",h)};console.log("setting up socket again"),T(!U),o()}),[U]),Object(u.jsx)("div",{className:"chatBox__container",children:Object(u.jsx)("div",{className:"chatBoxMain",children:M?Object(u.jsx)(d,{}):Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"chatBoxMiddle",children:Object(u.jsxs)("div",{className:"chatBox",children:[Object(u.jsxs)("div",{className:"chatHead",children:[Object(u.jsx)("div",{className:"backButton",onClick:function(){return G.push("/")},children:"Back"}),Object(u.jsxs)("p",{children:["Welcome to"," ",null===O||void 0===O||null===(t=O.chatroom)||void 0===t?void 0:t.name]})]}),Object(u.jsxs)("div",{className:"chatBody",children:[y.map((function(e,t){return Object(u.jsxs)("div",{className:"messages",children:[Object(u.jsx)("div",{className:F.user.id===e.user?"myName":"otherName",children:e.name}),Object(u.jsx)("span",{className:F.user.id===e.user?"myMessage":"OtherMessage",children:e.message})]},t)})),Object(u.jsx)(V,{})]}),Object(u.jsxs)("div",{className:"chatInput",children:[Object(u.jsx)("input",{value:g,onKeyUp:function(e){return Q(e,true)},onChange:function(e){return x(e.target.value)},placeholder:"New Message",type:"text"}),Object(u.jsxs)("button",{onClick:function(e){return Q(e)},children:[Object(u.jsx)("i",{className:"fas fa-paper-plane"}),Object(u.jsx)("p",{children:"Send"})]})]})]})}),Object(u.jsxs)("div",{className:"chatBoxRight",children:[Object(u.jsx)("div",{className:"chatBoxImgContainer",children:Object(u.jsx)("img",{className:"chatBoxImg",src:null===O||void 0===O||null===(c=O.chatroom)||void 0===c?void 0:c.image,alt:null===O||void 0===O||null===(n=O.chatroom)||void 0===n?void 0:n.name})}),Object(u.jsx)("p",{className:"chatBoxDesc",children:null===O||void 0===O||null===(s=O.chatroom)||void 0===s?void 0:s.description}),Object(u.jsxs)("p",{className:"chatBoxAdmin",children:["Room Owner:"," ",Object(u.jsx)("span",{children:(null===O||void 0===O?void 0:O.username)&&(J=O.username.split(" ")[0],J.charAt(0).toUpperCase()+J.substring(1))})]})]})]})})})},Z=c(64);c(132);var $=Object(j.i)((function(){var e=Object(l.b)(),t=Object(j.g)();return Object(u.jsxs)("div",{className:"header",children:[Object(u.jsxs)("div",{className:"headerLeft",onClick:function(){return t.push("/")},children:[Object(u.jsx)("img",{src:"https://icon-library.com/images/chat-icon-png/chat-icon-png-4.jpg",alt:""}),Object(u.jsx)("p",{children:"OpenChat"})]}),Object(u.jsxs)("div",{className:"headerNavItems",onClick:function(){return t.push("/create")},children:[Object(u.jsx)("i",{className:"fas fa-plus-circle"}),Object(u.jsx)("p",{children:"Create Chatroom"})]}),Object(u.jsxs)("div",{className:"headerNavItems",onClick:function(t){!function(t){t.preventDefault(),e(M())}(t)},children:[Object(u.jsx)("i",{className:"fas fa-sign-out-alt"}),Object(u.jsx)("p",{children:"Log Out"})]})]})}));var ee=function(){var e=Object(a.useState)(null),t=Object(i.a)(e,2),c=t[0],n=t[1],s=Object(l.b)(),r=Object(l.c)((function(e){return e.userLogin})),h=r.loading,O=r.userInfo,m=function e(){if((null===O||void 0===O?void 0:O.token)&&!c){var t=Z.io.connect("http://127.0.0.1:8000/api/",{query:{token:null===O||void 0===O?void 0:O.token}});t.on("disconnect",(function(){n(null),setTimeout(e,6e3)})),t.on("connect",(function(){console.log("Success: Socket Connected!")})),n(t)}};return Object(a.useEffect)((function(){localStorage.getItem("userInfo")&&s(function(){var e=Object(b.a)(p.a.mark((function e(t){var c,a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:E}),e.next=4,w.get("/user/me");case 4:c=e.sent,a=c.data,t({type:C,payload:a}),t({type:v,payload:a}),localStorage.setItem("userInfo",JSON.stringify(a)),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(0),"Not authorized, token failed"===(n=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message)&&t(M()),t({type:k,payload:n});case 16:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}())}),[s]),Object(a.useEffect)((function(){m()}),[]),Object(u.jsx)("div",{className:"App",children:Object(u.jsx)("div",{children:Object(u.jsx)(K.a,{children:h?Object(u.jsx)(d,{}):O?Object(u.jsxs)("div",{children:[Object(u.jsx)($,{}),Object(u.jsxs)(j.d,{children:[Object(u.jsx)(j.b,{path:"/",exact:!0,render:function(){return Object(u.jsx)(W,{socket:c})}}),Object(u.jsx)(j.b,{path:"/create",exact:!0,render:function(){return Object(u.jsx)(q,{})}}),Object(u.jsx)(j.b,{path:"/login",exact:!0,children:function(){return Object(u.jsx)(D,{setupSoc:m})}}),Object(u.jsx)(j.b,{path:"/chatpage/:id",exact:!0,render:function(e){return Object(u.jsx)(X,Object(o.a)(Object(o.a)({},e),{},{socket:c,setupSoc:m}))}}),Object(u.jsx)(j.a,{to:"/"})]})]}):Object(u.jsx)(D,{})})})})},te=c(18),ce=c(65),ae=c(66),ne=Object(te.combineReducers)({userLogin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return{loading:!0};case v:return{loading:!1,userInfo:t.payload};case g:return{loading:!1,error:t.payload};case x:return{};default:return e}},userRegister:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:return{loading:!0};case N:return{loading:!1,userInfo:t.payload};case y:return{loading:!1,error:t.payload};case x:return{};default:return e}},userDetails:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{user:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R:return Object(o.a)(Object(o.a)({},e),{},{loading:!0});case I:return{loading:!1,user:t.payload};case _:return{loading:!1,error:t.payload};case L:return{user:{}};default:return e}},userVerify:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E:return{loading:!0};case C:return{loading:!1,success:!0,userInfo:t.payload};case k:return{loading:!1,error:t.payload};default:return e}},chatroomList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{chatrooms:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case G:return{loading:!0,chatrooms:[]};case H:return{loading:!1,chatrooms:t.payload};case J:return{loading:!1,error:t.payload};default:return e}},chatroomCreate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Q:return{loading:!0};case V:return{loading:!1,success:!0,chatroom:t.payload};case z:return{loading:!1,error:t.payload};case P:return{};default:return e}}}),se={userLogin:{userInfo:localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")):null}},re=[ce.a],oe=Object(te.createStore)(ne,se,Object(ae.composeWithDevTools)(te.applyMiddleware.apply(void 0,re)));r.a.render(Object(u.jsx)(n.a.StrictMode,{children:Object(u.jsx)(l.a,{store:oe,children:Object(u.jsx)(ee,{})})}),document.getElementById("root"))},71:function(e,t,c){},76:function(e,t,c){},77:function(e,t,c){},78:function(e,t,c){},99:function(e,t,c){}},[[133,1,2]]]);
//# sourceMappingURL=main.8c6e27a5.chunk.js.map